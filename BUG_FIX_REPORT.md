# Streamlit ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒã‚°ä¿®æ­£ãƒ¬ãƒãƒ¼ãƒˆ

**ä¿®æ­£æ—¥æ™‚**: 2025-10-23
**ãƒ•ã‚¡ã‚¤ãƒ«**: `technical_analysis_app.py`

## ğŸ› ç™ºè¦‹ã•ã‚ŒãŸãƒã‚°

### å•é¡Œ: ã€Œåˆ†æå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚‚åˆ†æãŒå®Ÿè¡Œã•ã‚Œãªã„

**ç—‡çŠ¶**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ŒğŸš€ åˆ†æå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚‚ã€åˆ†æå‡¦ç†ãŒé–‹å§‹ã•ã‚Œãªã„
- ã€ŒğŸ‘ˆ ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰ã€ŒğŸš€ åˆ†æå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œç¶šã‘ã‚‹

**æ ¹æœ¬åŸå› **: ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆãƒ•ãƒ­ãƒ¼åˆ¶å¾¡ã®å•é¡Œï¼‰

### è©³ç´°ãªåŸå› åˆ†æ

**å•é¡Œã®ã‚ã£ãŸã‚³ãƒ¼ãƒ‰**:

```python
# å®Ÿè¡Œãƒœã‚¿ãƒ³ (130-132è¡Œ)
if st.sidebar.button("ğŸš€ åˆ†æå®Ÿè¡Œ", type="primary", use_container_width=True):
    st.session_state.analysis_results = None  # å‰å›ã®çµæœã‚’ã‚¯ãƒªã‚¢
    st.session_state.selected_symbol = symbols[0] if symbols else None

# åˆ†æå®Ÿè¡Œãƒ­ã‚¸ãƒƒã‚¯ (150-151è¡Œ)
elif st.session_state.analysis_results is None:
    st.info("ğŸ‘ˆ ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰ã€ŒğŸš€ åˆ†æå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„")
else:
    with st.spinner("åˆ†æä¸­..."):
        # åˆ†æå‡¦ç†...
```

**ãƒ­ã‚¸ãƒƒã‚¯ãƒ•ãƒ­ãƒ¼ã®å•é¡Œç‚¹**:

1. **ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚**:
   - `analysis_results` ã‚’ `None` ã«ãƒªã‚»ãƒƒãƒˆ
   - ã—ã‹ã—ã€ã“ã®æ™‚ç‚¹ã§ã¯åˆ†æã¯å®Ÿè¡Œã•ã‚Œãªã„

2. **æ¬¡ã®ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆStreamlitå†å®Ÿè¡Œæ™‚ï¼‰**:
   - `analysis_results is None` ã®æ¡ä»¶ãŒçœŸã«ãªã‚‹
   - 150-151è¡Œã® `elif` ãƒ–ãƒ©ãƒ³ãƒã«å…¥ã‚‹
   - ã€Œãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
   - **åˆ†æãŒå®Ÿè¡Œã•ã‚Œãªã„** â† ã“ã“ãŒå•é¡Œï¼

3. **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**:
   - ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ â†’ `analysis_results = None` â†’ **åˆ†æå®Ÿè¡Œ**
   - ã—ã‹ã—å®Ÿéš›ã¯: ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ â†’ `analysis_results = None` â†’ **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã®ã¿**

**ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯çŠ¶æ…‹**:
```
ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ â†’ analysis_results = None
    â†“
analysis_results is None â†’ "ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    â†‘_________________________________|

åˆ†æãŒæ°¸ä¹…ã«å®Ÿè¡Œã•ã‚Œãªã„ï¼
```

## âœ… å®Ÿæ–½ã—ãŸä¿®æ­£

### 1. ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ãƒˆã«å®Ÿè¡Œãƒ•ãƒ©ã‚°ã‚’è¿½åŠ 

**å¤‰æ›´ç®‡æ‰€**: 47-52è¡Œ

```python
# ä¿®æ­£å‰
if 'analysis_results' not in st.session_state:
    st.session_state.analysis_results = None
if 'selected_symbol' not in st.session_state:
    st.session_state.selected_symbol = None

# ä¿®æ­£å¾Œ
if 'analysis_results' not in st.session_state:
    st.session_state.analysis_results = None
if 'selected_symbol' not in st.session_state:
    st.session_state.selected_symbol = None
if 'run_requested' not in st.session_state:  # æ–°è¦è¿½åŠ 
    st.session_state.run_requested = False
```

### 2. ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã«å®Ÿè¡Œãƒ•ãƒ©ã‚°ã‚’è¨­å®š

**å¤‰æ›´ç®‡æ‰€**: 130-134è¡Œ

```python
# ä¿®æ­£å‰
if st.sidebar.button("ğŸš€ åˆ†æå®Ÿè¡Œ", type="primary", use_container_width=True):
    st.session_state.analysis_results = None
    st.session_state.selected_symbol = symbols[0] if symbols else None

# ä¿®æ­£å¾Œ
run_analysis = st.sidebar.button("ğŸš€ åˆ†æå®Ÿè¡Œ", type="primary", use_container_width=True)
if run_analysis:
    st.session_state.analysis_results = None
    st.session_state.selected_symbol = symbols[0] if symbols else None
    st.session_state.run_requested = True  # å®Ÿè¡Œãƒ•ãƒ©ã‚°ã‚’è¨­å®š
```

### 3. å®Ÿè¡Œãƒ•ãƒ©ã‚°ã«åŸºã¥ã„ã¦åˆ†æã‚’å®Ÿè¡Œ

**å¤‰æ›´ç®‡æ‰€**: 154-193è¡Œï¼ˆçµ±åˆåˆ†æãƒ¢ãƒ¼ãƒ‰ï¼‰

```python
# ä¿®æ­£å‰
elif st.session_state.analysis_results is None:
    st.info("ğŸ‘ˆ ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰ã€ŒğŸš€ åˆ†æå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„")
else:
    with st.spinner("åˆ†æä¸­..."):
        # åˆ†æå‡¦ç†...

# ä¿®æ­£å¾Œ
elif st.session_state.run_requested:
    with st.spinner("åˆ†æä¸­..."):
        try:
            # åˆ†æå‡¦ç†...
            st.session_state.run_requested = False  # ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
        except Exception as e:
            st.error(f"âŒ åˆ†æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {str(e)}")
            st.session_state.run_requested = False
else:
    st.info("ğŸ‘ˆ ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰ã€ŒğŸš€ åˆ†æå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„")
```

### 4. éŠ˜æŸ„æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ã‚‚åŒæ§˜ã«ä¿®æ­£

**å¤‰æ›´ç®‡æ‰€**: 418-453è¡Œ

åŒã˜ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ãŒéŠ˜æŸ„æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ã«ã‚‚ã‚ã£ãŸãŸã‚ã€åŒæ§˜ã®ä¿®æ­£ã‚’é©ç”¨ã€‚

### 5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®è¿½åŠ 

**æ–°è¦è¿½åŠ **: try-exceptãƒ–ãƒ­ãƒƒã‚¯

```python
try:
    # åˆ†æå‡¦ç†
    st.session_state.run_requested = False  # æˆåŠŸæ™‚ã«ãƒ•ãƒ©ã‚°ãƒªã‚»ãƒƒãƒˆ
except Exception as e:
    st.error(f"âŒ åˆ†æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {str(e)}")
    st.session_state.run_requested = False  # ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ãƒ•ãƒ©ã‚°ãƒªã‚»ãƒƒãƒˆ
```

## ğŸ”„ ä¿®æ­£å¾Œã®ãƒ•ãƒ­ãƒ¼

### æ­£ã—ã„å‹•ä½œãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
   â†“
2. run_requested = True ã‚’è¨­å®š
   â†“
3. Streamlitå†å®Ÿè¡Œ
   â†“
4. run_requested == True ã‚’æ¤œçŸ¥
   â†“
5. åˆ†æå‡¦ç†å®Ÿè¡Œ
   â†“
6. çµæœã‚’ analysis_results ã«ä¿å­˜
   â†“
7. run_requested = False ã«ãƒªã‚»ãƒƒãƒˆ
   â†“
8. çµæœã‚’è¡¨ç¤º
```

### çŠ¶æ…‹é·ç§»å›³

```
åˆæœŸçŠ¶æ…‹:
  run_requested = False
  analysis_results = None

ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯:
  run_requested = True
  analysis_results = None  (ãƒªã‚»ãƒƒãƒˆ)

åˆ†æå®Ÿè¡Œ:
  run_requested = True
  analysis_results = None  (å®Ÿè¡Œä¸­)
  â†“ (å®Œäº†)
  run_requested = False
  analysis_results = {ãƒ‡ãƒ¼ã‚¿}

çµæœè¡¨ç¤º:
  run_requested = False
  analysis_results = {ãƒ‡ãƒ¼ã‚¿}
```

## ğŸ“Š å½±éŸ¿ç¯„å›²

### ä¿®æ­£ã—ãŸãƒ¢ãƒ¼ãƒ‰

1. âœ… **ğŸ” çµ±åˆåˆ†æï¼ˆæ¨å¥¨ï¼‰** - ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ä¿®æ­£
2. âœ… **âš–ï¸ éŠ˜æŸ„æ¯”è¼ƒ** - ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ä¿®æ­£
3. âšª **ğŸ² ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆ** - ç‹¬è‡ªãƒœã‚¿ãƒ³ã®ãŸã‚å•é¡Œãªã—
4. âšª **ğŸ“Š ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ã®ã¿** - æœªå®Ÿè£…ã®ãŸã‚å½±éŸ¿ãªã—
5. âšª **ğŸ’¼ ãƒ•ã‚¡ãƒ³ãƒ€ãƒ¡ãƒ³ã‚¿ãƒ«ã®ã¿** - æœªå®Ÿè£…ã®ãŸã‚å½±éŸ¿ãªã—

### ä¿®æ­£è¡Œæ•°

- ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ãƒˆåˆæœŸåŒ–: 2è¡Œè¿½åŠ 
- ãƒœã‚¿ãƒ³ãƒ­ã‚¸ãƒƒã‚¯: 3è¡Œè¿½åŠ 
- çµ±åˆåˆ†æãƒ¢ãƒ¼ãƒ‰: 40è¡Œä¿®æ­£ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å«ã‚€ï¼‰
- éŠ˜æŸ„æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰: 36è¡Œä¿®æ­£ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å«ã‚€ï¼‰

**åˆè¨ˆ**: ç´„80è¡Œã®å¤‰æ›´

## âœ… æ¤œè¨¼

### æ§‹æ–‡ãƒã‚§ãƒƒã‚¯

```bash
$ uv run python -m py_compile technical_analysis_app.py
# ã‚¨ãƒ©ãƒ¼ãªã— - æˆåŠŸ
```

### æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ŒğŸš€ åˆ†æå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œåˆ†æä¸­...ã€ã‚¹ãƒ”ãƒŠãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
3. Technicalåˆ†æã¨Fundamentalåˆ†æãŒä¸¦åˆ—å®Ÿè¡Œã•ã‚Œã‚‹
4. çµæœãŒ3ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§è¡¨ç¤ºã•ã‚Œã‚‹
5. ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«ã¯é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹

## ğŸ“ å­¦ã‚“ã æ•™è¨“

### Streamlitã®çŠ¶æ…‹ç®¡ç†ã®æ³¨æ„ç‚¹

1. **ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã¯1ãƒ•ãƒ¬ãƒ¼ãƒ ã®ã¿**:
   - `st.button()` ã®æˆ»ã‚Šå€¤ã¯æ¬¡ã®ãƒ•ãƒ¬ãƒ¼ãƒ ã§ã¯ `False` ã«ãªã‚‹
   - ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã®åŠ¹æœã‚’æŒç¶šã•ã›ã‚‹ã«ã¯ `session_state` ã‚’ä½¿ç”¨

2. **æ¡ä»¶åˆ†å²ã®é †åºãŒé‡è¦**:
   - `if`-`elif`-`else` ã®é †åºã‚’æ…é‡ã«è¨­è¨ˆ
   - çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆå¾Œã®å‹•ä½œã‚’è€ƒæ…®

3. **æ˜ç¤ºçš„ãªå®Ÿè¡Œãƒ•ãƒ©ã‚°**:
   - `None` ãƒã‚§ãƒƒã‚¯ã ã‘ã§ã¯ä¸ååˆ†
   - ã€Œãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã€ã¨ã„ã†æ˜ç¤ºçš„ãªãƒ•ãƒ©ã‚°ãŒå¿…è¦

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

```python
# æ‚ªã„ä¾‹: Noneãƒã‚§ãƒƒã‚¯ã®ã¿
if data is None:
    show_message()
else:
    compute_data()
    data = result

# è‰¯ã„ä¾‹: æ˜ç¤ºçš„ãªãƒ•ãƒ©ã‚°
if run_requested:
    compute_data()
    data = result
    run_requested = False
elif data is None:
    show_message()
else:
    show_data()
```

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ä¿®æ­£å®Œäº†ã«ã‚ˆã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

### æ¨å¥¨ã•ã‚Œã‚‹è¿½åŠ ãƒ†ã‚¹ãƒˆ

1. **çµ±åˆåˆ†æãƒ¢ãƒ¼ãƒ‰**:
   - å˜ä¸€éŠ˜æŸ„åˆ†æ
   - è¤‡æ•°éŠ˜æŸ„åˆ†æ
   - ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ï¼ˆç„¡åŠ¹ãªã‚·ãƒ³ãƒœãƒ«ï¼‰

2. **éŠ˜æŸ„æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰**:
   - 2éŠ˜æŸ„æ¯”è¼ƒ
   - 5éŠ˜æŸ„ä»¥ä¸Šã®æ¯”è¼ƒ
   - æ··åœ¨ãƒ‡ãƒ¼ã‚¿ï¼ˆä¸€éƒ¨å¤±æ•—ï¼‰

3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**:
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‹•ä½œç¢ºèª
   - å¤§é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†

## ğŸ“ ã¾ã¨ã‚

**ãƒã‚°ã®æœ¬è³ª**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç†ã®ä¸å‚™ã«ã‚ˆã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼

**ä¿®æ­£å†…å®¹**: å®Ÿè¡Œãƒ•ãƒ©ã‚° (`run_requested`) ã®å°å…¥ã«ã‚ˆã‚‹çŠ¶æ…‹ç®¡ç†ã®æ”¹å–„

**çµæœ**: ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ç¢ºå®Ÿã«åˆ†æãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ä¿®æ­£å®Œäº†

---

**ä¿®æ­£å®Œäº†**: âœ… ã™ã¹ã¦ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ­£å¸¸ã«å‹•ä½œã—ã¾ã™ã€‚
